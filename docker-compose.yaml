
x-environment: &environment
  DEBUG: 1

x-logging-options: &logging
  options:
    max-size: "10m"
    max-file: "2"


services:
  ci:
    build:
      context: .
      args:
        - SRV=${SRV}
      dockerfile: ci/Dockerfile
    image: ${REG}/ci/${SRV}:${CI}
    environment:
      - CLOUDFLARE_API_TOKEN=${CLOUDFLARE_API_TOKEN}
      - CLOUDFLARE_ACCOUNT_ID=${CLOUDFLARE_ACCOUNT_ID}
    volumes:
      # - ./app:/app
      - ./app_theme:/app
    network_mode: host
    # ports:
    #   - 4321:4321
    command: npm run dev --host 0.0.0.0

networks:
  default:
    external: true
    name: rt_default
  proxy:
    external: true
